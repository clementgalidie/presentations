<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Intro Ruby</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/beige.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section>
        	<h1>Rails Introduction</h1>
        </section>

        <section>
          <h1>Rails ? What is this?</h1>
          <div>

            <p>Rails is a Ruby framework for web application.</p>

            <p>Rails philosophy :</p>
            <ul>
              <li>DRY (Don’t Repeat Yourself)</li>
              <li>Convention Over Configuration.</li>
              <li>REST (Representational State Transfer : standard Http)</li>
            </ul>

        	<p>http://guides.rubyonrails.org/ </p>
          </div>
        </section>

        <section>
          <h1>MVC architecture</h1>
            <ul>
              <li>Models</li>
              <li>Views</li>
              <li>Controllers</li>
            </ul>
        </section>

        <section>
          <h1>Rails components</h1>
          <ul>
            <li>Action Pack (Action Controller (manage parameters, session, template and redirection), Action View (interface) et Action Dispatch (routing))</li>
            <li>Action Mailer</li>
            <li>Active Model (OMR)</li>
            <li>Active Record (base des modèles Rails, CRUD)</li>
            <li>Active Support (utility class)</li>
          </ul>
        </section>

        <section>
          <h1>Create an application</h1>
          <ul>
            <li>
              rails new market
            </li>
            <li>
              Zoom in a application's folder
            </li>
            <li>
              rake
            </li>
           <li>
              rails route
            </li>
        </section>

        <section>
          <h1>Models : Migration</h1>
              <p>File that you can change the database</p>
              <p>rails generate migration CreateArticles</p>
              <p>Available functions : </p>
              <ul>
                <li>create_table</li>
                <li>change_table</li>
                <li>drop_table</li>
                <li>add_column</li>
                <li>change_column</li>
                <li>rename_column</li>
                <li>remove_column</li>
                <li>add_index</li>
                <li>remove_index</li>
              </ul>
        </section>

        <section>
          <h1>Models : Migration</h1>
              <p>Example : </p>
              <pre><code class="ruby">
create_table :products do |t|
      t.string :name
      t.text :description
      t.timestamps
end

rake db:migrate
rake db:rollback
            </code>
            </pre>

        </section>

        <section>
          <h1>Validations and Callbacks</h1>
              <div>
                              <pre><code class="ruby">
p = Person.new(:name => "John Doe")
p.new_record?
true
p.save
true
p.new_record?
false
                                </code>
                                </pre>
              </div>
        	  <p>Many methods to save an object : </p>
        		<ul>
        		<li>create</li>
        		<li>save</li>
            <li>update_attributes</li>
        		</ul>
        </section>

        <section>
          <h1>Validations and Callbacks</h1>
          <pre><code class="ruby">acceptance (validates :terms_of_service, :acceptance => true)
confirmation (validates :email, :confirmation => true)
exclusion (validates :terms_of_service, :acceptance => true)
format (validates :subdomain, :exclusion => { :in => %w(www us ca jp), :message => "Subdomain %{value} is reserved." })
inclusion (validates :size, :inclusion => { :in => %w(small medium large), :message => "%{value} is not a valid size" })
length (validates :name, :length => { :minimum => 2 })
numericality (validates :points, :numericality => true)
presence (validates :order_id, :presence => true)
uniqueness (validates :email, :uniqueness => true)
            </code>
            </pre>
        </section>

        <section>
          <h1>Validations and Callbacks</h1>
          <ul>
            <li>
              <div>
                <pre><code class="ruby">
class Person < ActiveRecord::Base
  validates :name, :presence => true
end

 p = Person.new
#Person id: nil, name: nil
p.errors
{}

p.valid?
false
p.errors
{:name=>["can't be blank"]}

p = Person.create
#Person id: nil, name: nil
p.errors
{:name=>["can't be blank"]}

p.save
false

p.save!
ActiveRecord::RecordInvalid: Validation failed: Name cant be blank

Person.create!
ActiveRecord::RecordInvalid: Validation failed: Name cant be blank
                  
                  </code>
                  </pre>
              </div>
            </li>
          </ul>
        </section>

        <section>
          <h1>Validations and Callbacks</h1>
        	<p>Create/Update/Destroy : </p>
        		<ul>
        		<li>before_validation</li>
        		<li>after_validation</li>
        		<li>before_save</li>
        		<li>around_save</li>
        		<li>before_create</li>
        		<li>around_create</li>
        		<li>after_create</li>
        		<li>after_save</li>

        		</ul>

        		    
        </section>
<section>
  <div>
    <pre><code class="ruby">class Person < ActiveRecord::Base
  validates :name, :presence => true
  after_create :todo

  def todo
  end
end
    </code></pre>
</div>
</section>
        <section>
          <h1>Associations</h1>
        		<ul>
        		<li>belongs_to</li>
        		<li>has_one</li>
        		<li>has_many</li>
        		<li>has_many :through</li>
        		<li>has_one :through</li>
        		<li>has_and_belongs_to_many</li>
        		</ul>
        </section>

        <section>
          <h1>belongs_to/has_many  (1,1/1,n)</h1>
        			    <div>
        			      <pre><code class="ruby">
class Order < ActiveRecord::Base
  belongs_to :customer
end
 class Customer < ActiveRecord::Base
  has_many :orders
end
        			      </code></pre>
              </div>
        </section>

        <section>
          <h1>has_many :through (n/n)</h1>
        			    <div>
        			      <pre><code class="ruby">class Physician < ActiveRecord::Base
  has_many :appointments
  has_many :patients, :through => :appointments
end

class Appointment < ActiveRecord::Base
  belongs_to :physician
  belongs_to :patient
end

class Patient < ActiveRecord::Base
  has_many :appointments
  has_many :physicians, :through => :appointments
end
        			        </code>
        			        </pre>

              </div>
        </section>
        <section>
          <h1>has_and_belongs_to_many (n/n)</h1>
        			    <div>
        			      <pre><code class="ruby">class Assembly < ActiveRecord::Base
  has_and_belongs_to_many :parts
end

class Part < ActiveRecord::Base
  has_and_belongs_to_many :assemblies
end
        			        </code>
        			        </pre>

              </div>
        </section>


        <section>
          <h1>Active Record : Les requetes</h1>
        			    <div>
        			      <pre><code class="ruby">client = Client.find(10)
client = Client.first
client = Client.last
Client.where("orders_count = ?", params[:orders])
Client.where(:locked => true)
Client.where(:orders_count => [1,3,5])
Client.order("created_at")
Client.limit(5).offset(30)
Client.connection.select_all("SELECT * FROM clients WHERE id = '1'")
        			        </code>
        			        </pre>
              </div>
        </section>


        <section>
          <h1>Active Record : Scopes</h1>
        			    <div>
<pre><code class="ruby">class User
  scope :majors, where(:major => true)
  scope :by_age, lambda do |age|
  	joins(:profile).where('profile.age = ?', age) unless age.nil?
  end
  scope :by_name, lambda{ |name| where(name: name) unless name.nil? }
  scope :by_email, lambda do |email|
  	joins(:profile).where('profile.email = ?', email) unless email.nil?
  end
end
        </code>
        </pre>
              </div>
        </section>


        <section>
           <h1>Action Controller</h1>
                   <div>
                     <pre><code class="ruby">class ClientsController < ApplicationController

def new
  @client = Client.new
end

end
</code></pre>
               </div>

             <p>params #request parameters (hash)</p>
         <p> <pre><code>{ :name => "acme", :address => "123 Carrot Street", :company => { :name => "acme", :address => "123 Carrot Street" }}</code></pre></p>
             </section>
             <section>
           <h1>Action Controller - Render</h1>
           <p>Many formats : json, html, xml, xls...</p>
                   <div>
                     <pre><code class="ruby">class UsersController < ApplicationController
 def index
   @users = User.all
   respond_to do |format|
     format.html # index.html.erb
     format.xml  { render :xml => @users}
     format.json { render :json => @users}
   end
 end
end
                       </code></pre>
         </div>
             </section>

              <section>
           <h1>Action Controller - Filter</h1>
           <p>Filters are methods that are run before, after a controller action.</p>
                   <div>
                     <pre><code class="ruby">class ApplicationController < ActionController::Base
before_action :require_login
private

def require_login
 unless logged_in?
   flash[:error] = "You must be logged in to access this section"
   redirect_to new_login_url # halts request cycle
 end
end

def logged_in?
 !current_user
end
end

class LoginsController < ApplicationController
  skip_before_action :require_login, :only => [:new, :create]
end
                       </code>
                       </pre>

         </div>

             </section>
      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: 'beige', //Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });

    </script>

  </body>
</html>
